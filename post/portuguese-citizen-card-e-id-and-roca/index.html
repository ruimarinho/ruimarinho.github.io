<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.69.0"><title>Portuguese Citizen Card (e-ID) and ROCA - Rui Marinho</title><meta property="og:title" content="Portuguese Citizen Card (e-ID) and ROCA - Rui Marinho"><link rel=icon href=https://ruimarinho.github.io/images/ type=image/x-icon><link rel=stylesheet href=https://ruimarinho.github.io/css/main.css media=all><link rel=stylesheet href="//fonts.googleapis.com/css?family=Merriweather:400|Lato:400,400italic,700"><link rel=stylesheet href=https://ruimarinho.github.io/css/pre.css media=all></head><body><div class=wrapper><header class=header><nav class=nav><a href=https://ruimarinho.github.io/ class=nav-logo><img src=https://ruimarinho.github.io/images/profile.jpg width=50 height=50 alt="Rui's Profile Picture"></a><ul class=nav-links><li><a href=https://ruimarinho.github.io/about/>about</a></li><li><a href=https://github.com/ruimarinho>github</a></li><li><a href=https://ruimarinho.github.io/>posts</a></li><li><a href=https://twitter.com/ruipmarinho>twitter</a></li></ul></nav></header><main class=content role=main><article class=article><span class=article-duration>2 min read</span><h1 class=article-title>Portuguese Citizen Card (e-ID) and ROCA</h1><span class=article-date>November 7, 2017</span><div class=article-content><blockquote><p>A newly discovered vulnerability in generation of RSA keys used by a software library adopted in cryptographic smartcards, security tokens and other secure hardware chips manufactured by Infineon Technologies AG allows for a practical factorization attack, in which the attacker computes the private part of an RSA key. The attack is feasible for commonly used key lengths, including 1024 and 2048 bits, and affects chips manufactured as early as 2012, that are now commonplace. [1]</p></blockquote><p>Portugal has migrated to an electronic ID (e-ID) citizen card (<em>Cart達o do Cidad達o</em>) in 2007, with the first trials occurring in Azores at that time. The full roll-out took place in 2008 and four years later, 7 million cards were already in circulation [2].</p><p>In case you&rsquo;re wondering, the selected contractor for <em>Cart達o do Cidad達o</em> was Gemalto using its <em>Sealys eID</em> platform [2] and the company confirmed it <a href=https://www.theregister.co.uk/2017/10/23/roca_crypto_flaw_gemalto/>has been affected by ROCA as well</a>. According to them, only smartcards based on the <em>IDPrime.NET</em> platform were subject to this vulnerability.</p><p>The dangers of compromising a private key are frightening. In Portugal, the e-ID is used extensively in the public sector as it is mandatory for signing contracts and documents. In the private area, it is commonly used for authenticating in public services and for submitting digitally signed documents. Voting is still paper-based.</p><p>I&rsquo;ve used the <a href=https://github.com/crocs-muni/roca>roca-test</a> utility to find out whether the certificates installed on my e-ID were resistant to ROCA. Fortunately, they are.</p><p>[1] <a href=https://crocs.fi.muni.cz/public/papers/rsa_ccs17>ROCA: Vulnerable RSA generation (CVE-2017-15361)</a></p><p>[2] <a href=http://www.gemalto.com/brochures-site/download-site/Documents/portugal_eID.pdf>Portuguese Citizen&rsquo;s Card - Gemalto</a></p></div></article></main><footer class=footer><ul class=footer-links><li><a href=https://ruimarinho.github.io/index.xml type=application/rss+xml target=_blank>RSS feed</a></li></ul></footer></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-90727541-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>