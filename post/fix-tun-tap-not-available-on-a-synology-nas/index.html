<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.69.0"><title>Fix TUN/TAP not available on a Synology NAS - Rui Marinho</title><meta property="og:title" content="Fix TUN/TAP not available on a Synology NAS - Rui Marinho"><link rel=icon href=https://ruimarinho.github.io/images/ type=image/x-icon><link rel=stylesheet href=https://ruimarinho.github.io/css/main.css media=all><link rel=stylesheet href="//fonts.googleapis.com/css?family=Merriweather:400|Lato:400,400italic,700"><link rel=stylesheet href=https://ruimarinho.github.io/css/pre.css media=all></head><body><div class=wrapper><header class=header><nav class=nav><a href=https://ruimarinho.github.io/ class=nav-logo><img src=https://ruimarinho.github.io/images/profile.jpg width=50 height=50 alt="Rui's Profile Picture"></a><ul class=nav-links><li><a href=https://ruimarinho.github.io/about/>about</a></li><li><a href=https://github.com/ruimarinho>github</a></li><li><a href=https://ruimarinho.github.io/>posts</a></li><li><a href=https://twitter.com/ruipmarinho>twitter</a></li></ul></nav></header><main class=content role=main><article class=article><span class=article-duration>1 min read</span><h1 class=article-title>Fix TUN/TAP not available on a Synology NAS</h1><span class=article-date>September 5, 2017</span><div class=article-content><p>If you&rsquo;re looking into running OpenVPN on your Synology NAS, you may have come across the following error:</p><pre><code>ERROR: Cannot open TUN/TAP dev /dev/net/tun: No such file or directory (errno=2)
</code></pre><p>Let&rsquo;s try to fix it!</p><h2 id=check-the-tun-module-status>Check the tun module status</h2><p>Check if you have the <code>tun</code> module installed:</p><pre><code>❯ lsmod | grep tun
</code></pre><p>If the result comes out empty, try installing it:</p><pre><code>❯ insmod /lib/modules/tun.ko
</code></pre><p>If everything went fine, move on to the next test.</p><h4 id=test-if-the-tunko-module-works>Test if the tun.ko module works</h4><p>Now let&rsquo;s make sure the <code>tun.ko</code> module works as expected:</p><pre><code>❯ mkdir /dev/net
❯ mknod /dev/net/tun c 10 200
❯ chmod 600 /dev/net/tun
❯ cat /dev/net/tun
</code></pre><p>If the result of the <code>cat</code> command was <code>File descriptor in bad state</code>, it means the module has been correctly installed.</p><h4 id=make-tunko-module-persistent>Make tun.ko module persistent</h4><p>The module installation needs to be made persistent otherwise on every Synology restart, you&rsquo;ll have to repeat the <code>insmod</code> command.</p><p>Create the following file to run on every system boot:</p><pre><code>❯ cat &lt;&lt;EOF &gt; /usr/local/etc/rc.d/tun.sh
#!/bin/sh -e

insmod /lib/modules/tun.ko
EOF
</code></pre><p>Make the script executable:</p><pre><code>❯ chmod a+x /usr/local/etc/rc.d/tun.sh
</code></pre><p>Reboot your Synology NAS or execute the script manually once. Done!</p></div></article></main><footer class=footer><ul class=footer-links><li><a href=https://ruimarinho.github.io/index.xml type=application/rss+xml target=_blank>RSS feed</a></li></ul></footer></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-90727541-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>